<% 
  # Structure du menu hiérarchique selon guide-ux-ui.md et inventaire-active-admin.md
  # Menu items avec structure complète
%>

<!-- SIDEBAR: Desktop/Tablet (hidden on mobile) -->
<aside class="d-none d-lg-flex flex-column bg-dark text-white border-end position-fixed admin-sidebar" 
       id="sidebar" 
       data-admin--admin-sidebar-target="sidebar"
       data-controller="admin--admin-sidebar">
  
  <!-- Header avec logo/titre -->
  <div class="p-3 border-bottom border-secondary d-flex align-items-center justify-content-between position-relative">
    <span class="d-inline fw-bold sidebar-label" id="sidebar-logo-text">Grenoble Roller</span>
    <button class="btn btn-sm btn-outline-light d-none d-lg-block position-absolute end-0 me-3 admin-sidebar-toggle"
            data-action="click->admin--admin-sidebar#toggle"
            aria-label="Réduire la sidebar">
      <i class="bi bi-chevron-left"></i>
    </button>
  </div>

  <!-- Navigation menu -->
  <nav class="flex-grow-1 overflow-y-auto px-2 py-3">
    <ul class="nav nav-pills flex-column gap-2">
      <%= render 'admin/shared/menu_items', mobile: false %>
    </ul>
  </nav>

  <!-- Footer -->
  <div class="p-3 border-top border-secondary">
    <div class="small text-muted">
      <div class="sidebar-label"><%= current_user.email %></div>
      <%= link_to destroy_user_session_path, method: :delete, 
          class: "text-white-50 text-decoration-none small sidebar-label",
          data: { bs_dismiss: "" } do %>
        <i class="bi bi-box-arrow-right me-1"></i>Déconnexion
      <% end %>
    </div>
  </div>
</aside>

<!-- OFFCANVAS: Mobile only - Pleine largeur (100vw) -->
<div class="offcanvas offcanvas-start bg-dark text-white" 
     tabindex="-1" 
     id="offcanvasSidebar" 
     role="navigation"
     aria-labelledby="offcanvasSidebarLabel"
     data-bs-backdrop="true"
     data-bs-scroll="false">
  <div class="offcanvas-header border-bottom border-secondary">
    <h5 class="offcanvas-title" id="offcanvasSidebarLabel">Menu</h5>
    <button type="button" 
            class="btn-close btn-close-white" 
            data-bs-dismiss="offcanvas" 
            aria-label="Fermer le menu"
            style="min-width: 44px; min-height: 44px;">
    </button>
  </div>
  <div class="offcanvas-body p-0">
    <!-- Navigation avec role sémantique -->
    <nav class="w-100" role="navigation" aria-label="Menu principal">
      <ul class="nav nav-pills flex-column w-100 m-0 p-0">
        <%= render 'admin/shared/menu_items', mobile: true %>
      </ul>
    </nav>
  </div>
</div>

<!-- Hamburger button (fixed mobile, top right) -->
<div class="d-lg-none admin-mobile-menu-toggle">
  <button class="btn btn-outline-light btn-lg"
          type="button"
          data-bs-toggle="offcanvas"
          data-bs-target="#offcanvasSidebar"
          aria-label="Ouvrir le menu"
          aria-expanded="false"
          aria-controls="offcanvasSidebar">
    <i class="bi bi-list fs-4" aria-hidden="true"></i>
    <span class="visually-hidden">Menu</span>
  </button>
</div>
