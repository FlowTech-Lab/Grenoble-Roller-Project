#!/bin/bash
# Helper script pour Ã©diter les credentials Rails dans Docker
# Usage: bin/edit-credentials [dev|staging|production]

set -e

ENV="${1:-dev}"
COMPOSE_FILE="ops/${ENV}/docker-compose.yml"

if [ ! -f "$COMPOSE_FILE" ]; then
  echo "âŒ Fichier docker-compose.yml introuvable : $COMPOSE_FILE"
  exit 1
fi

echo "ğŸ“ Ã‰dition des credentials Rails (environnement: $ENV)"
echo "ğŸ’¡ Utilisez Ctrl+O pour sauvegarder, Ctrl+X pour quitter dans nano"
echo ""

# La commande correcte avec docker compose run --rm -it
docker compose -f "$COMPOSE_FILE" run --rm -it -e EDITOR=nano web bin/rails credentials:edit
